

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with Particle Sets &mdash; AMUSE 12.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Integrate a C++ code" href="c_code.html" />
    <link rel="prev" title="Estimating the typical mass of the most massive star in a cluster" href="most_massive_from_salpeter.html" />
     
    <link rel="stylesheet" href="../_static/default.css" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AMUSE
          

          
          </a>

          
            
            
              <div class="version">
                12.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="units.html">Working with Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html#quantities">Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html#working-with-arrays">Working with arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="most_massive_from_salpeter.html">Estimating the typical mass of the most massive star in a cluster</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with Particle Sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#there-are-sets-subsets-particles-children-and-parents">There are Sets, Subsets, Particles, Children and Parents…</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-stars-in-a-plummer-model">Selecting stars in a plummer model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#selection">Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-operations">Set operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iteration">Iteration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indexation">Indexation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-codes">Using codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#channels">Channels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#particle-hierarchies">Particle Hierarchies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methods-to-retreive-physical-properties-of-the-particles-set">Methods to retreive physical properties of the particles set</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="c_code.html">Integrate a C++ code</a></li>
<li class="toctree-l2"><a class="reference internal" href="fortran_code.html">Integrate a Fortran 90 code</a></li>
<li class="toctree-l2"><a class="reference internal" href="gravitational_dynamics_code.html">Adding a Gravitational Dynamics Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="legacy_code.html">Create an low-level Interface to a Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="blender.html">Using Blender for visualising Amuse results</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html">Plotting with amuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="grid_boundary.html">Setting values for grid boundaries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactive_tutorial/index.html">Interactive tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/index.html">Design documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AMUSE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Working with Particle Sets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/particle_sets.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-particle-sets">
<h1>Working with Particle Sets<a class="headerlink" href="#working-with-particle-sets" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../_images/sets.png"><img alt="../_images/sets.png" src="../_images/sets.png" style="width: 2cm;" /></a>
<div class="section" id="there-are-sets-subsets-particles-children-and-parents">
<h2>There are Sets, Subsets, Particles, Children and Parents…<a class="headerlink" href="#there-are-sets-subsets-particles-children-and-parents" title="Permalink to this headline">¶</a></h2>
<p>The fundamental data structures used in AMUSE are particle sets. Based
on attributes of the elements in the sets (particles), selections can
be made using the selection method which return subsets. These subsets
are views or scopes on the set and do not hold values of their own.</p>
<p>It is also possible to <em>add</em> structure to the set by defining
parent-child relationships between <strong>particles in a set</strong>.
These structures exist only in the set and are a property
of it and have no meaning with respect to the particles
outside the set.</p>
</div>
<div class="section" id="selecting-stars-in-a-plummer-model">
<h2>Selecting stars in a plummer model<a class="headerlink" href="#selecting-stars-in-a-plummer-model" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial we generate a set of stars, a plummer model, and
two subsets of stars. The first subset contains the stars within
a certain radius from the center of mass of the plummer system and
the second subset contains all the other stars.</p>
<p>The plummer module generates a particle set of the form datamodel.Stars(<em>N</em>).</p>
<div class="section" id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h3>
<p>We start with some AMUSE imports in a python shell:
The core module contains the set objects, and the units and nbody_system
are needed for the correct assignment of properties to
the particles, which <strong>need to be quantities</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse</span> <span class="kn">import</span> <span class="n">datamodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.units</span> <span class="kn">import</span> <span class="n">nbody_system</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.units</span> <span class="kn">import</span> <span class="n">units</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.ic.plummer</span> <span class="kn">import</span> <span class="n">new_plummer_sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
<div class="section" id="model">
<h3>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A quick way to look at the sets we are going to make
is by using gnuplot. If you have gnuplot, you can install
the <strong>gnuplot-py</strong> package to control gnuplot directly
from your script.</p>
<p>To install <strong>gnuplot-py</strong>, open a shell and do:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">easy_install</span> <span class="n">gnuplot</span><span class="o">-</span><span class="n">py</span>
</pre></div>
</div>
</div>
<p>Let’s generate a plummer model consisting of 1000 stars,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_nbody</span> <span class="o">=</span> <span class="n">nbody_system</span><span class="o">.</span><span class="n">nbody_to_si</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">MSun</span><span class="p">,</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plummer</span> <span class="o">=</span> <span class="n">new_plummer_sphere</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">convert_nbody</span><span class="p">)</span>
</pre></div>
</div>
<p>We can work on the new <strong>plummer</strong> particle set, but we want to keep this
set unchanged for now. So, we copy all data to a working set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span> <span class="o">=</span> <span class="n">plummer</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To look at the stars in gnuplot do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">Gnuplot</span><span class="o">.</span><span class="n">Gnuplot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span><span class="o">.</span><span class="n">splot</span><span class="p">(</span><span class="n">plummer</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">value_in</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../_images/plummer11.png" class="last" src="../_images/plummer11.png" />
</div>
</div>
<div class="section" id="selection">
<h3>Selection<a class="headerlink" href="#selection" title="Permalink to this headline">¶</a></h3>
<p>At this stage we select the subsets based on the distance of the
individual stars with respect to the center of mass, being
<strong>1 parsec</strong> in this example.</p>
<p>We need the center of mass, of course:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">center_of_mass</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">()</span>
</pre></div>
</div>
<p>and the selection of the sets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">innersphere</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">center_of_mass</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">1.0</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">,[</span><span class="s2">&quot;position&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outersphere</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">center_of_mass</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">&gt;=</span><span class="mf">1.0</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">,[</span><span class="s2">&quot;position&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To look at the stars in gnuplot do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">Gnuplot</span><span class="o">.</span><span class="n">Gnuplot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span><span class="o">.</span><span class="n">splot</span><span class="p">(</span><span class="n">outersphere</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">value_in</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">),</span> <span class="n">innersphere</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">value_in</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">),)</span>
</pre></div>
</div>
<img alt="../_images/plummer2.png" class="last" src="../_images/plummer2.png" />
</div>
<p>We can achieve the same result in another way by using the fact that outersphere is the difference of the innersphere set
and the stars set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outersphere_alt</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">innersphere</span><span class="p">)</span>
</pre></div>
</div>
<p>or using the particle subtraction ‘-‘ operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outersphere_alt2</span> <span class="o">=</span> <span class="n">stars</span> <span class="o">-</span> <span class="n">innersphere</span>
</pre></div>
</div>
<p>The selections are all subsets as we can verify:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outersphere</span> 
<span class="go">&lt;amuse.datamodel.particles.ParticlesSubset object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="set-operations">
<h3>Set operations<a class="headerlink" href="#set-operations" title="Permalink to this headline">¶</a></h3>
<p>The result should be the same, but we’ll check:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hopefuly_empty</span> <span class="o">=</span> <span class="n">outersphere</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">outersphere_alt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hopefuly_empty</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">outersphere</span> <span class="o">-</span> <span class="n">outersphere_alt2</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>From our selection criteria we would expect to have selected all stars, to check this we could do something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">innersphere</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">outersphere</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1000</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">innersphere</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">outersphere_alt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1000</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">innersphere</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">outersphere_alt2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1000</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The union of the innersphere and outersphere set should give the stars set, we can check:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">like_stars</span> <span class="o">=</span> <span class="n">innersphere</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">outersphere</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">like_stars</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">innersphere</span> <span class="o">+</span> <span class="n">outersphere_alt2</span> <span class="o">-</span> <span class="n">stars</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="iteration">
<h3>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h3>
<p>We can iterate over sets and we will put that to use here to check whether we really selected the right stars in the outersphere:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">should_not_be_there_stars</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">outersphere</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="p">(</span><span class="n">center_of_mass</span><span class="o">-</span><span class="n">star</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">1.0</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">parsec</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">should_not_be_there_stars</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">should_not_be_there_stars</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<div class="section" id="indexation">
<h3>Indexation<a class="headerlink" href="#indexation" title="Permalink to this headline">¶</a></h3>
<p>Not very set like, but can-do.</p>
</div>
</div>
<div class="section" id="using-codes">
<h2>Using codes<a class="headerlink" href="#using-codes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="channels">
<h3>Channels<a class="headerlink" href="#channels" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="../_images/channels.png"><img alt="../_images/channels.png" class="align-center" src="../_images/channels.png" style="width: 2cm;" /></a>
<p>Imagine we evaluate stars in some MPI bound legacy code, and want to know what happened to the stars in our subsets. Each query for attributes in de
code set invokes one MPI call, which is inefficient if we have many queries. Copying the entire set to the model, however, costs only one MPI call too
and we can query from the model set at will without the MPI overhead. Copying the data from one existing set to another set <em>or</em> subset
can be done via channels.</p>
<p>First we define a simple dummy legacy code object, with some typical gd interface methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DummyLegacyCode</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span> <span class="o">=</span> <span class="n">datamodel</span><span class="o">.</span><span class="n">Particles</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_particles</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">add_particles</span><span class="p">(</span><span class="n">new_particles</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">update_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particles</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">copy_values_of_state_attributes_to</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">particles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">evolve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">position</span> <span class="o">*=</span> <span class="mf">1.1</span>
</pre></div>
</div>
<p>We instantiate the code and use it to evolve (expand) our plummer model. We add a channel to our innersphere subset to track the changes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">code</span> <span class="o">=</span> <span class="n">DummyLegacyCode</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_to_innersphere</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">particles</span><span class="o">.</span><span class="n">new_channel_to</span><span class="p">(</span><span class="n">innersphere</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code</span><span class="o">.</span><span class="n">add_particles</span><span class="p">(</span><span class="n">stars</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code</span><span class="o">.</span><span class="n">evolve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_inner_init</span> <span class="o">=</span> <span class="n">innersphere</span><span class="o">.</span><span class="n">position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_outer_init</span> <span class="o">=</span> <span class="n">outersphere</span><span class="o">.</span><span class="n">position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_to_innersphere</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_inner_fini</span> <span class="o">=</span> <span class="n">innersphere</span><span class="o">.</span><span class="n">position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_outer_fini</span> <span class="o">=</span> <span class="n">outersphere</span><span class="o">.</span><span class="n">position</span>
</pre></div>
</div>
<p>Checking the changes by looking at the positions (all changed after the evolve), we will see that only the innersphere particles are updated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">r_inner_init</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">r_inner_fini</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">r_outer_init</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">r_outer_fini</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If we want to update all particles in our model, we can use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">code</span><span class="o">.</span><span class="n">update_particles</span><span class="p">(</span><span class="n">stars</span><span class="p">)</span>
</pre></div>
</div>
<p>and check:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_outer_fini</span> <span class="o">=</span> <span class="n">outersphere</span><span class="o">.</span><span class="n">position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">r_outer_init</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">r_outer_fini</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="particle-hierarchies">
<h2>Particle Hierarchies<a class="headerlink" href="#particle-hierarchies" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/children.png"><img alt="../_images/children.png" src="../_images/children.png" style="width: 2cm;" /></a>
<p>Let us suppose that the zero-th star, stars[0] has a child and a grandchild star who do not belong to the plummer model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">child_star</span> <span class="o">=</span> <span class="n">datamodel</span><span class="o">.</span><span class="n">Particle</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grandchild_star</span> <span class="o">=</span> <span class="n">datamodel</span><span class="o">.</span><span class="n">Particle</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_star</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">MSun</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_star</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">AU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_star</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">AUd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grandchild_star</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">MSun</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grandchild_star</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">AU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grandchild_star</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="n">units</span><span class="o">.</span><span class="n">AUd</span>
</pre></div>
</div>
<p>We can add them as child and grandchild etc. to the set of plummer stars. But first we have to add them to the set as regular stars:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">child_star_in_set</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">add_particle</span><span class="p">(</span><span class="n">child_star</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grandchild_star_in_set</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">add_particle</span><span class="p">(</span><span class="n">grandchild_star</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can define the hierarchy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">child_star_in_set</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_star_in_set</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">grandchild_star_in_set</span><span class="p">)</span>
</pre></div>
</div>
<p>The descendants of star 0 form a subset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">descendents</span><span class="p">()</span> 
<span class="go">&lt;amuse.datamodel.ParticlesSubset object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">()</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">value_in</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">MSun</span><span class="p">)</span>
<span class="go">array([ 0.001])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">descendents</span><span class="p">()</span><span class="o">.</span><span class="n">mass</span>
<span class="go">quantity&lt;[1.98892e+26, 1.98892e+27] kg&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="methods-to-retreive-physical-properties-of-the-particles-set">
<h2>Methods to retreive physical properties of the particles set<a class="headerlink" href="#methods-to-retreive-physical-properties-of-the-particles-set" title="Permalink to this headline">¶</a></h2>
<p>Particle sets have a number of functions for calculating physical
properties that apply to the sets. Although some of these might be implemented
in the legacy codes as well, using them via particle sets guarantees
the applicability to <em>all</em> particles when multiple legacy codes
are used. Furthermore, the particle set functions provide a uniform
way of doing the calculations. Speed might be the downside.</p>
<span class="target" id="module-amuse.datamodel.particle_attributes"></span><dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>particles</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the center of mass of the particles set.
The center of mass is defined as the average
of the positions of the particles, weighted by their masses.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">()</span>
<span class="go">quantity&lt;[0.0, 0.0, 0.0] m&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">center_of_mass_velocity</code><span class="sig-paren">(</span><em>particles</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the center of mass velocity of the particles set.
The center of mass velocity is defined as the average
of the velocities of the particles, weighted by their masses.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">center_of_mass_velocity</span><span class="p">()</span>
<span class="go">quantity&lt;[0.0, 0.0, 0.0] m * s**-1&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">kinetic_energy</code><span class="sig-paren">(</span><em>particles</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the total kinetic energy of the
particles in the particles set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">kinetic_energy</span><span class="p">()</span>
<span class="go">quantity&lt;1.0 m**2 * kg * s**-2&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">potential_energy</code><span class="sig-paren">(</span><em>particles</em>, <em>smoothing_length_squared=quantity&lt;zero&gt;</em>, <em>G=quantity&lt;6.67428e-11 m**3 * kg**-1 * s**-2&gt;</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the total potential energy of the particles in the particles set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>smooting_length_squared</strong> – gravitational softening, added to every distance**2.</li>
<li><strong>G</strong> – gravitational constant, need to be changed for particles in different units systems</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">potential_energy</span><span class="p">()</span>
<span class="go">quantity&lt;-6.67428e-11 m**2 * kg * s**-2&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">particle_specific_kinetic_energy</code><span class="sig-paren">(</span><em>set</em>, <em>particle</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the specific kinetic energy of the particle.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">specific_kinetic_energy</span><span class="p">()</span>
<span class="go">quantity&lt;0.5 m**2 * s**-2&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">amuse.datamodel.particle_attributes.</code><code class="descname">particle_potential</code><span class="sig-paren">(</span><em>set</em>, <em>particle</em>, <em>smoothing_length_squared=quantity&lt;zero&gt;</em>, <em>G=quantity&lt;6.67428e-11 m**3 * kg**-1 * s**-2&gt;</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the potential at the position of the particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>smooting_length_squared</strong> – gravitational softening, added to every distance**2.</li>
<li><strong>G</strong> – gravitational constant, need to be changed for particles in different units systems</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">amuse.datamodel</span> <span class="k">import</span> <span class="n">Particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span> <span class="o">=</span> <span class="n">Particles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">|</span> <span class="n">units</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span><span class="p">()</span>
<span class="go">quantity&lt;-6.67428e-11 m**2 * s**-2&gt;</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="c_code.html" class="btn btn-neutral float-right" title="Integrate a C++ code" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="most_massive_from_salpeter.html" class="btn btn-neutral float-left" title="Estimating the typical mass of the most massive star in a cluster" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2019 The AMUSE Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
    <!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.amusecode.org/" : "http://stats.amusecode.org/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.amusecode.org/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

     


</body>
</html>