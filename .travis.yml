codecov: true
compiler: gcc
env:
  global:
    - OMPI_MCA_rmaps_base_oversubscribe=true
  matrix:
    # - PYTHON_VERSION=3.5
    # - PYTHON_VERSION=3.6
    - PYTHON_VERSION=3.7

dist: bionic
matrix:
  os:
    - linux
    # - osx
  include:
    - python: 3.7
      env: TOXENV=py37
      - name: "openmpi py37 linux"
        language: python
        addons:
          apt:
            packages:
              - build-essential
              - python3-dev
              - gfortran
              - libgsl0-dev
              - cmake
              - libfftw3-3
              - libfftw3-dev
              - libmpfr6
              - libmpfr-dev
              - libhdf5-serial-dev
              - hdf5-tools
              - libopenmpi-dev
              - openmpi-bin
  
      - name: "mpich py37 linux"
        language: python
        addons:
          apt:
            packages:
              - build-essential
              - python3-dev
              - gfortran
              - libgsl0-dev
              - cmake
              - libfftw3-3
              - libfftw3-dev
              - libmpfr6
              - libmpfr-dev
              - libhdf5-serial-dev
              - hdf5-tools
              - libmpich-dev
              - mpich


before_install:
  # - if [[ $TRAVIS_OS_NAME == linux ]]; then ; fi
  # - if [[ $TRAVIS_OS_NAME == osx ]]; then
  #     something;
  #   fi
  # - pip install --upgrade pip

install:
  - pip install numpy scipy matplotlib docutils mpi4py pytest
  # - pip install pytest-cov codecov pytest-timeout
  - pip install tox

virtualenv:
  system_site_packages: false

script:
  - tox
  
after_success:
  - codecov
