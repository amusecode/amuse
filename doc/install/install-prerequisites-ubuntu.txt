Installing on Ubuntu
====================

Installing on Ubuntu version > 10.10
-------------------------------------

In this section we asume a default Ubuntu desktop installation.

All
---
The prerequisites can be installed with a couple of commands
on Ubuntu. The only choice to make is between openmpi and mpich2. Most
of our testing is done with MPICH2 but openmpi should also work.

For openmpi do::

	> sudo apt-get install build-essential gfortran python-dev \
	  libopenmpi-dev openmpi-bin \
	  libgsl0-dev cmake libfftw3-3 libfftw3-dev \
	  libgmp3-dev libmpfr4 libmpfr-dev \
	  libhdf5-serial-dev hdf5-tools \
	  python-nose python-numpy python-setuptools python-docutils \
	  python-h5py python-setuptools
	
	> sudo easy_install mpi4py

For mpich2 do::
	
	> sudo apt-get install build-essential gfortran python-dev \
  	  libmpich-dev \
  	  libgsl0-dev cmake libfftw3-3 libfftw3-dev \
  	  libgmp3-dev libmpfr4 libmpfr-dev \
  	  libhdf5-serial-dev hdf5-tools \
  	  python-nose python-numpy python-setuptools python-docutils \
  	  python-h5py python-setuptools
	  
Download the mpich2-1.2.tar.gz file from the below link: 
http://www.mpich.org/static/downloads/1.2/mpich2-1.2.tar.gz

	1. Unpack the tar file.
	> tar xfz mpich2-1.2.tar.gz

	2. Choose an installation directory (the default is /usr/local/bin):
	> mkdir /home/you/mpich2-install

	(*you* is your username)

It will be most convenient if this directory is shared by all of the 
machines where you intend to run processes. If not, you will have to 
duplicate it on the other machines after installation. 
Now get inside the mpich2 folder.
	
	> cd mpich2-1.2

3. Configure MPICH2 specifying the installation directory:
	
	for csh and tcsh:
	> ./configure --prefix=/home/you/mpich2-install |& tee c.txt
	for bash and sh:
	> ./configure --prefix=/home/you/mpich2-install 2>&1 | tee c.txt
	
	4. Build MPICH2:
	for csh and tcsh:
	> make |& tee m.txt
	for bash and sh:
	> make 2>&1 | tee m.txt
	
	5. Install the MPICH2 commands:
	for csh and tcsh:
	> make install |& tee mi.txt
	for bash and sh:
	> make install 2>&1 | tee mi.txt
	
If the installation fails with errors like *“permission denied”*. 
Try executing the make command again with root privileges:
	
	for csh and tcsh:
	> sudo make install |& tee mi.txt
	for bash and sh:
	> sudo make install 2>&1 | tee mi.txt

	6. Add the bin subdirectory of the installation 
	directory to your path:
	
	for csh and tcsh:
	> setenv PATH /home/you/mpich2-install/bin:$PATH
	for bash and sh:
	> PATH=/home/you/mpich2-install/bin:$PATH ; export PATH
	
Remember to add the bin to the subdirectory everytime you want to 
run mpich in a new terminal. You can also permanently add it to your 
**PATH** to avoid typing this command everytime you want to run mpd.
Check that everything is in order at this point by doing 
	
	> which mpd
	> which mpiexec
	> which mpirun
	
All should refer to the commands in the bin subdirectory of your 
install directory. Now Install mpi4py:

	> sudo easy_install mpi4py
		   OR
	> sudo pip install mpi4py

(whichever works for you)

.. note::
	
	Please make sure not to install mpich2 and openmpi together. 
	When both openmpi and mpich2 are installed strange errors
	will occur and AMUSE will not work. If you see both installed
	please remove both and install one.

Installing on Ubuntu 9.04
~~~~~~~~~~~~~~~~~~~~~~~~~

In this section we asume a default Ubuntu desktop installation.

Python
------
Ubuntu comes with python2.6 pre-installed, you can check if
python is installed by doing:

.. code-block:: sh

	> python --version
	Python 2.6.2

If this failes with an error or a version before 2.6, please install 
python first(the package is called ``python2.6``). You also need 
the ``python2.6-dev`` development package.
To install it, do::

    > sudo apt-get install python2.6-dev
    

GCC
---
By default, Ubuntu does not install a fortran 90 or a C++ compiler. We
suggest using gfortran and g++. These compilers are installed with
the ``build-essential`` and the ``gfortran`` package. 
To install these, do::

    > sudo apt-get install build-essential gfortran

MPI2
----
Ubuntu does not provide installation packages for MPICH2. You can 
build MPICH2 by hand (a good HOWTO can be found at 
https://wiki.ubuntu.com/MpichCluster). Or, you can download and install
pre-build packages from the MPICH2 site (http://www.mcs.anl.gov/research/projects/mpich2/index.php).

If you prefer OpenMpi over MPICH2, you can install openmpi
from the Ubuntu packages. To install
the openmpi packages, do::

     > sudo apt-get install libopenmpi-dev openmpi-bin 

HDF5
----
Amuse can work with HDF5 versions 1.6.* and 1.8.3. Ubuntu 9.04 comes
with HDF5 version 1.6.6. To install it, do::

    > sudo apt-get install libhdf5-serial-dev hdf5-tools 

FFTW
----
On Ubuntu, FFTW can be installed with::

    > sudo apt-get install libfftw3 libfftw3-dev libfftw3-doc

GSL
-------
On Ubuntu, GSL can be installed with::

    > sudo apt-get install libgsl0 libgsl0-dev

CMake
-------
CMake is used to build EVTwin. On Ubuntu, CMake can be installed with::

    > sudo apt-get install cmake

GMP
-------
GMP is required for Adaptb. On Ubuntu, GMP can be installed with::

    > sudo apt-get install libgmp3 libgmp3-dev

MPFR
-------
MPFR is required for Adaptb. On Ubuntu, MPFR can be installed with::

    > sudo apt-get install libmpfr4 libmpfr-dev

Python packages in Ubuntu
-------------------------
Ubuntu comes with python packages for nose and numpy. You also need 
the setuptools package to be able to install the ``mpi4py`` and ``h5py`` 
software. To install these , do::

    > sudo apt-get install python-nose python-numpy python-setuptools python-docutils

Python packages with easy_install
---------------------------------
The ``mpi4py`` and ``h5py`` can be installed with the ``easy_install``
command::

    > sudo easy_install mpi4py
    > sudo easy_install h5py
    
Installing on Ubuntu 9.10
~~~~~~~~~~~~~~~~~~~~~~~~~

In this section we asume a default Ubuntu desktop installation. This 
installation is for the most part the same as for Ubuntu 9.04, see 
previous section. 

The development packages of python are needed, to install these do::

    > sudo apt-get install python-dev 

FFTW
-------
For 9.10 the FFTW package name is fftw3 and not libfftw3, FFTW can be installed with::

    > sudo apt-get install fftw3 fftw3-dev fftw3-doc

